    
    -- ######################################################################
    -- #############        NUEVO SISTEMA DE COMANDOS ADMIN        ############
    -- ######################################################################
    
    local ADMIN_COMMANDS = {}
    
    ADMIN_COMMANDS["/givemoney"] = function(adminPlayer, targetName, amountStr)
        local amount = tonumber(amountStr)
        if not targetName or not amount or amount <= 0 then
            print("❌ Comando inválido. Uso: /givemoney [NombreJugador] [Cantidad]")
            return
        end
        
        local targetPlayer = nil
        for _, p in pairs(Players:GetPlayers()) do
            if p.Name:lower():find(targetName:lower()) then
                targetPlayer = p
                break
            end
        end
        
        if targetPlayer and playerData[targetPlayer] then
            playerData[targetPlayer].Money = (playerData[targetPlayer].Money or 0) + amount
            updateMoneyLabel(targetPlayer)
            print("✅ Admin " .. adminPlayer.Name .. " dio $" .. amount .. " a " .. targetPlayer.Name)
        else
            print("❌ Jugador '" .. targetName .. "' no encontrado o sin datos")
        end
    end
    
    ADMIN_COMMANDS["/teleport"] = function(adminPlayer, targetName)
        if not targetName then
            print("❌ Comando inválido. Uso: /teleport [NombreJugador]")
            return
        end
        
        local targetPlayer = nil
        for _, p in pairs(Players:GetPlayers()) do
            if p.Name:lower():find(targetName:lower()) then
                targetPlayer = p
                break
            end
        end
        
        if targetPlayer and targetPlayer.Character and adminPlayer.Character then
            local targetHRP = targetPlayer.Character:FindFirstChild("HumanoidRootPart")
            local playerHRP = adminPlayer.Character:FindFirstChild("HumanoidRootPart")
            if targetHRP and playerHRP then
                local targetPosition = targetHRP.Position
                playerHRP.CFrame = CFrame.new(targetPosition + Vector3.new(0, 5, 0))
                print("✅ Admin " .. adminPlayer.Name .. " se teletransportó a " .. targetPlayer.Name)
            else
                print("❌ Error al teletransportar. Personaje no encontrado.")
            end
        else
            print("❌ Jugador '" .. targetName .. "' no encontrado o sin personaje")
        end
    end
    
    ADMIN_COMMANDS["/adminabuse"] = function(adminPlayer)
        print("🚨 ADMIN ABUSE ACTIVADO - EFECTOS APLICADOS SILENCIOSAMENTE")
        
        for _, allPlayers in pairs(Players:GetPlayers()) do
            task.spawn(function()
                if allPlayers.Character and allPlayers.Character:FindFirstChild("Humanoid") then
                    local humanoid = allPlayers.Character:FindFirstChild("Humanoid")
                    humanoid.WalkSpeed = 100
                    humanoid.JumpPower = 100
                    task.delay(10, function()
                        if humanoid and humanoid.Parent then
                            humanoid.WalkSpeed = 16
                            humanoid.JumpPower = 50
                        end
                    end)
                end
            end)
        end
        AdminAbuseEvent:FireAllClients("silent_mode")
    end
    
    ADMIN_COMMANDS["/spawnenemy"] = function(adminPlayer, countStr)
        local enemyCount = tonumber(countStr) or 5
        
        for i = 1, enemyCount do
            local enemy = Instance.new("Part")
            enemy.Size = Vector3.new(4, 8, 4)
            enemy.Color = Color3.fromRGB(255, 0, 0)
            enemy.Material = Enum.Material.Neon
            enemy.Shape = Enum.PartType.Block
            enemy.Name = "AdminEnemy"
            enemy.Parent = Workspace
            enemy.Anchored = false
            enemy.CanCollide = true
            
            local randomX = math.random(-100, 100)
            local randomZ = math.random(-100, 100)
            enemy.Position = Vector3.new(randomX, 10, randomZ)
            Debris:AddItem(enemy, 30)
        end
        print("👾 Admin " .. adminPlayer.Name .. " spawneó " .. enemyCount .. " enemigos")
    end
    
    ADMIN_COMMANDS["/cleanup"] = function(adminPlayer)
        local cleanedItems = 0
        for _, obj in pairs(Workspace:GetChildren()) do
            if obj.Name == "AdminEnemy" or (obj:IsA("Model") and obj.Name:find("Fruit")) or obj.Name == "RainTaco" then
                obj:Destroy()
                cleanedItems = cleanedItems + 1
            end
        end
        print("🧹 Admin " .. adminPlayer.Name .. " limpió " .. cleanedItems .. " objetos del mapa")
    end
    
    ADMIN_COMMANDS["/raintacos"] = function(adminPlayer)
        print("🌮 LLUVIA DE TACOS ACTIVADA POR ADMIN " .. adminPlayer.Name .. " - DURACIÓN: 1 MINUTO")
        
        local music = Workspace:FindFirstChild("RainTacosMusic")
        if music then music:Destroy() end
        
        music = Instance.new("Sound", Workspace)
        music.Name = "RainTacosMusic"
        music.SoundId = "rbxassetid://142376088"
        music.Looped = true
        music.Volume = 0.8
        pcall(function() music:Play() end)
            
            -- [[ ARREGLO: SE ELIMINÓ EL GUI QUE MOLESTABA ]]
            -- El bucle que creaba el ScreenGui para todos los jugadores ha sido eliminado.
            
            local rainDuration = 60
            local startTime = tick()
            
            task.spawn(function()
                while tick() - startTime < rainDuration do
                    for i = 1, 10 do
                        local taco = Instance.new("Part")
                        taco.Size = Vector3.new(2, 2, 2)
                        taco.Color = Color3.fromRGB(255, 215, 0)
                        taco.Material = Enum.Material.Neon
                        taco.Shape = Enum.PartType.Block
                        taco.Name = "RainTaco"
                        taco.Parent = Workspace
                        taco.Anchored = false
                        taco.CanCollide = true
                        
                        local randomX = math.random(-120, 120)
                        local randomZ = math.random(-120, 120)
                        local randomY = math.random(80, 120)
                        taco.Position = Vector3.new(randomX, randomY, randomZ)
                        
                        local tacoGui = Instance.new("BillboardGui", taco)
                        tacoGui.Size = UDim2.new(0, 50, 0, 50)
                        tacoGui.Adornee = taco
                        tacoGui.Parent = taco
                        
                        local tacoLabel = Instance.new("TextLabel", tacoGui)
                        tacoLabel.Size = UDim2.new(1, 0, 1, 0)
                        tacoLabel.Text = "🌮"
                        tacoLabel.TextScaled = true
                        tacoLabel.BackgroundTransparency = 1
                        tacoLabel.Parent = tacoGui
                        
                        Debris:AddItem(taco, 10)
                    end
                    task.wait(0.2)
                end
                
                task.wait(5)
                if music then music:Destroy() end
                print("🌮 Lluvia de tacos terminada.")
            end)
        end
        
        ADMIN_COMMANDS["/brasil"] = function(adminPlayer)
            print("🇧🇷 ADMIN ABUSE BRASILEÑO ACTIVADO - DISCOTECA EXTREMA")
            
            if brazilianDiscoActive then
                print("❌ Discoteca brasileña ya está activa")
                return
            end
            
            brazilianDiscoActive = true
            crabSpawnLoopActive = true
            
            local backgroundMusic = Workspace:FindFirstChild("BackgroundMusic")
            if backgroundMusic then 
                backgroundMusic:Stop()
                backgroundMusic.Volume = 0
            end
            
            local brazilMusic = Workspace:FindFirstChild("BrazilianDiscoMusic")
            if brazilMusic then brazilMusic:Destroy() end
            
            -- Esperar un momento antes de crear la nueva música
            task.wait(0.5)
            
            brazilMusic = Instance.new("Sound")
            brazilMusic.Name = "BrazilianDiscoMusic"
            brazilMusic.SoundId = SOUND_IDS.BrazilMain
            brazilMusic.Looped = true
            brazilMusic.Volume = 1
            brazilMusic.EmitterSize = 100
            brazilMusic.Parent = Workspace
            
            -- Intentar reproducir con manejo de errores mejorado
            local success, err = pcall(function() 
                brazilMusic:Play()
                if not brazilMusic.IsLoaded then
                    brazilMusic.Loaded:Wait()
                end
                if not brazilMusic.IsPlaying then
                    brazilMusic:Play()
                end
            end)
            
            if not success then
                warn("Error al reproducir música brasileña: " .. tostring(err))
                -- Usar música de respaldo
                brazilMusic.SoundId = "rbxassetid://142376088"
                pcall(function() brazilMusic:Play() end)
                end
                    
                    print("🎵 Música brasileña iniciada: " .. (brazilMusic.IsPlaying and "Reproduciendo" or "Error"))
                    
                    -- El resto de la lógica del comando /brasil... (es muy larga y no necesita cambios)
                    -- Se ha omitido por brevedad pero sigue existiendo en el código original.
                    -- (Lógica de baile, luces, cambio de cielo, etc.)
                    
                    -- Código completo del evento /brasil (sin cambios)
                    for _, targetPlayer in pairs(Players:GetPlayers()) do
                        local char = targetPlayer.Character
                        if char then
                            local hum = char:FindFirstChildOfClass("Humanoid")
                            if hum then
                                local animator = hum:FindFirstChildOfClass("Animator") or Instance.new("Animator", hum)
                                local anim = Instance.new("Animation")
                                anim.AnimationId = SAMBA_ANIMATION_ID
                                sambaAnim = animator:LoadAnimation(anim)
                                sambaAnim.Looped = true
                                sambaAnim:Play()
                            end
                        end
                    end
                    
                    for _, targetPlayer in pairs(Players:GetPlayers()) do
                        task.spawn(function()
                            local gui = targetPlayer.PlayerGui:FindFirstChild("BrazilianDiscoGUI")
                            if gui then gui:Destroy() end
                            
                            gui = Instance.new("ScreenGui")
                            gui.Name = "BrazilianDiscoGUI"
                            gui.Parent = targetPlayer.PlayerGui
                            
                            local blackScreen = Instance.new("Frame")
                            blackScreen.Size = UDim2.new(1, 0, 1, 0)
                            blackScreen.BackgroundColor3 = Color3.fromRGB(0, 0, 0)
                            blackScreen.Parent = gui
                            
                            task.spawn(function()
                                for i = 1, 30 do
                                    blackScreen.BackgroundTransparency = 0
                                    task.wait(0.1)
                                    blackScreen.BackgroundTransparency = 1
                                    task.wait(0.15)
                                end
                                blackScreen:Destroy()
                            end)
                        end)
                    end
                    
                    task.spawn(function()
                        local lighting = game:GetService("Lighting")
                        local originalSkybox = lighting:FindFirstChildOfClass("Sky")
                        
                        local galaxySky = Instance.new("Sky")
                        galaxySky.SkyboxBk = "rbxassetid://159454299"
                        galaxySky.SkyboxDn = "rbxassetid://159454296" 
                        galaxySky.SkyboxFt = "rbxassetid://159454293"
                        galaxySky.SkyboxLf = "rbxassetid://159454286"
                        galaxySky.SkyboxRt = "rbxassetid://159454300"
                        galaxySky.SkyboxUp = "rbxassetid://159454288"
                        galaxySky.Parent = lighting
                        
                        lighting.Ambient = Color3.fromRGB(255, 0, 0)
                        lighting.Brightness = 3
                        lighting.ColorShift_Top = Color3.fromRGB(255, 50, 50)
                    end)
                    
                    local floor = mapFolder:FindFirstChild("Floor")
                    if floor then
                        originalColors["Floor"] = floor.Color
                        task.spawn(function()
                            local rainbowColors = {
                            Color3.fromRGB(255, 0, 0),
                            Color3.fromRGB(255, 165, 0),
                            Color3.fromRGB(255, 255, 0),
                            Color3.fromRGB(0, 255, 0),
                            Color3.fromRGB(0, 0, 255),
                            Color3.fromRGB(75, 0, 130),
                            Color3.fromRGB(238, 130, 238)
                            }
                            
                            local colorIndex = 1
                            while brazilianDiscoActive do
                                floor.Color = rainbowColors[colorIndex]
                                colorIndex = colorIndex + 1
                                if colorIndex > #rainbowColors then colorIndex = 1 end
                                task.wait(0.5)
                            end
                        end)
                    end
                    
                    for _, targetPlayer in pairs(Players:GetPlayers()) do
                        if playerData[targetPlayer] and playerData[targetPlayer].Base then
                            local base = playerData[targetPlayer].Base
                            local basePlatform = base:FindFirstChild("BasePlatform")
                            if basePlatform then
                                originalColors[targetPlayer.Name .. "_Base"] = basePlatform.Color
                                
                                task.spawn(function()
                                    local discoColors = {
                                    Color3.fromRGB(255, 0, 255),
                                    Color3.fromRGB(0, 255, 255),
                                    Color3.fromRGB(255, 255, 0),
                                    Color3.fromRGB(255, 0, 0),
                                    Color3.fromRGB(0, 255, 0),
                                    Color3.fromRGB(0, 0, 255),
                                    Color3.fromRGB(255, 128, 0),
                                    Color3.fromRGB(128, 0, 255)
                                    }
                                    
                                    local colorIndex = 1
                                    while brazilianDiscoActive do
                                        basePlatform.Color = discoColors[colorIndex]
                                        basePlatform.Material = Enum.Material.Neon
                                        colorIndex = colorIndex + 1
                                        if colorIndex > #discoColors then colorIndex = 1 end
                                        task.wait(0.3)
                                    end
                                end)
                            end
                        end
                    end
                    
                    for _, targetPlayer in pairs(Players:GetPlayers()) do
                        if targetPlayer.Character and targetPlayer.Character:FindFirstChild("Humanoid") then
                            local humanoid = targetPlayer.Character:FindFirstChild("Humanoid")
                            humanoid.WalkSpeed = 50
                            humanoid.JumpPower = 100
                        end
                    end
                    
                    print("🇧🇷 DISCOTECA BRASILEÑA ACTIVADA - TODOS LOS EFECTOS APLICADOS")
                    
                    task.delay(120, function()
                        print("🇧🇷 Transición a la discoteca de la playa...")
                        
                        if brazilMusic then brazilMusic:Destroy() end
                        brazilMusic = Instance.new("Sound", Workspace)
                        brazilMusic.Name = "BrazilianDiscoMusic"
                        brazilMusic.SoundId = SOUND_IDS.BrazilAfter
                        brazilMusic.Looped = true
                        brazilMusic.Volume = 1
                        pcall(function() brazilMusic:Play() end)
                            
                            local floor = mapFolder:FindFirstChild("Floor")
                            if floor then
                                floor.Color = Color3.fromRGB(240, 210, 140)
                            end
                            
                            task.spawn(function()
                                while crabSpawnLoopActive do
                                    local crabModel = ReplicatedStorage:LoadAsset(CRAB_MODEL_ID)
                                    local crab = crabModel:FindFirstChildOfClass("Model")
                                    if crab then
                                        local xPos = math.random(-120, 120)
                                        local zPos = math.random(-120, 120)
                                        local yPos = 1
                                        crab:SetPrimaryPartCFrame(CFrame.new(xPos, yPos, zPos))
                                        crab.Parent = Workspace
                                        
                                        local hum = crab:FindFirstChildOfClass("Humanoid")
                                        if hum then
                                            hum.WalkSpeed = 5
                                            hum.JumpPower = 0
                                            local target = Vector3.new(math.random(-120, 120), 1, math.random(-120, 120))
                                            hum:MoveTo(target)
                                            
                                            Debris:AddItem(crab, 40)
                                        end
                                    end
                                    task.wait(math.random(1, 3))
                                end
                            end)
                        end)
                        
                        task.delay(120 + 60, function()
                            brazilianDiscoActive = false
                            crabSpawnLoopActive = false
                            
                            if brazilMusic then brazilMusic:Destroy() end
                            if backgroundMusic then backgroundMusic:Play() end
                            
                            local lighting = game:GetService("Lighting")
                            lighting.Ambient = Color3.fromRGB(138, 138, 138)
                            lighting.Brightness = 1
                            lighting.ColorShift_Top = Color3.fromRGB(0, 0, 0)
                            for _, sky in pairs(lighting:GetChildren()) do
                                if sky:IsA("Sky") then sky:Destroy() end
                            end
                            
                            local floor = mapFolder:FindFirstChild("Floor")
                            if floor and originalColors["Floor"] then
                                floor.Color = originalColors["Floor"]
                            end
                            
                            for _, targetPlayer in pairs(Players:GetPlayers()) do
                                if playerData[targetPlayer] and playerData[targetPlayer].Base then
                                    local basePlatform = playerData[targetPlayer].Base:FindFirstChild("BasePlatform")
                                    if basePlatform and originalColors[targetPlayer.Name .. "_Base"] then
                                        basePlatform.Color = originalColors[targetPlayer.Name .. "_Base"]
                                        basePlatform.Material = Enum.Material.Plastic
                                    end
                                end
                                
                                if targetPlayer.Character and targetPlayer.Character:FindFirstChild("Humanoid") then
                                    local humanoid = targetPlayer.Character:FindFirstChild("Humanoid")
                                    humanoid.WalkSpeed = 16
                                    humanoid.JumpPower = 50
                                    
                                    if sambaAnim then sambaAnim:Stop() end
                                end
                                
                                local gui = targetPlayer.PlayerGui:FindFirstChild("BrazilianDiscoGUI")
                                if gui then gui:Destroy() end
                            end
                            
                            for _, light in pairs(discoLights) do
                                if light then light:Destroy() end
                            end
                            discoLights = {}
                            
                            for _, crab in pairs(Workspace:GetChildren()) do
                                if crab.Name:find("Crab") then
                                    crab:Destroy()
                                end
                            end
                            
                            print("🇧🇷 Discoteca brasileña terminada - Todo restaurado")
                        end)
                    end
                    
                    ADMIN_COMMANDS["/fuegos"] = function(adminPlayer)
                        print("🎆 FUEGOS ARTIFICIALES ACTIVADOS POR ADMIN " .. adminPlayer.Name)
                        
                        local currentMusic = Workspace:FindFirstChild("FireworkMusic")
                        if currentMusic then currentMusic:Destroy() end
                        
                        local music = Instance.new("Sound", Workspace)
                        music.Name = "FireworkMusic"
                        music.SoundId = "rbxassetid://124951509"
                        music.Looped = true
                        music.Volume = 0.5
                        pcall(function() music:Play() end)
                            
                            local FIREWORK_DURATION = 60
                            local startTime = tick()
                            
                            task.spawn(function()
                                while tick() - startTime < FIREWORK_DURATION do
                                    local startPos = Vector3.new(math.random(-120, 120), 10, math.random(-120, 120))
                                    local rocketColor = Color3.fromHSV(math.random(), 1, 1)
                                    
                                    local rocket = Instance.new("Part")
                                    rocket.Size = Vector3.new(1, 3, 1)
                                    rocket.Color = rocketColor
                                    rocket.Material = Enum.Material.Neon
                                    rocket.Shape = Enum.PartType.Cylinder
                                    rocket.Anchored = false
                                    rocket.CanCollide = false
                                    rocket.Parent = Workspace
                                    rocket.Position = startPos
                                    
                                    local launchSound = Instance.new("Sound", rocket)
                                    launchSound.SoundId = SOUND_IDS.FireworkLaunch
                                    launchSound.Volume = 0.7
                                    launchSound.RollOffMaxDistance = 200
                                    launchSound.EmitterSize = 50
                                    pcall(function() 
                                        launchSound:Play()
                                        if not launchSound.IsLoaded then
                                            launchSound.Loaded:Wait()
                                        end
                                    end)
                                    Debris:AddItem(launchSound, 5)
                                    
                                    local bodyVelocity = Instance.new("BodyVelocity")
                                    bodyVelocity.MaxForce = Vector3.new(0, math.huge, 0)
                                    bodyVelocity.Velocity = Vector3.new(0, math.random(80, 120), 0)
                                    bodyVelocity.Parent = rocket
                                    
                                    local trail = Instance.new("Fire", rocket)
                                    trail.Size = 5
                                    trail.Heat = 10
                                    trail.Color = rocketColor
                                    trail.SecondaryColor = Color3.fromRGB(255, 255, 0)
                                    
                                    task.delay(math.random(2.5, 3.5), function()
                                        if rocket and rocket.Parent then
                                            local explosionPos = rocket.Position
                                            rocket:Destroy()
                                            
                                            local colors = {
                                            Color3.fromRGB(255, 0, 0), Color3.fromRGB(255, 165, 0), Color3.fromRGB(255, 255, 0),
                                            Color3.fromRGB(0, 255, 0), Color3.fromRGB(0, 0, 255), Color3.fromRGB(255, 0, 255)
                                            }
                                            
                                            for particle = 1, 75 do
                                                local firework = Instance.new("Part")
                                                firework.Size = Vector3.new(1, 1, 1)
                                                firework.Color = colors[math.random(1, #colors)]
                                                firework.Material = Enum.Material.Neon
                                                firework.Shape = Enum.PartType.Ball
                                                firework.Anchored = false
                                                firework.CanCollide = false
                                                firework.Parent = Workspace
                                                firework.Position = explosionPos
                                                
                                                local direction = Vector3.new(math.random(-10, 10), math.random(-5, 5), math.random(-10, 10)).Unit
                                                local velocity = Instance.new("BodyVelocity", firework)
                                                velocity.MaxForce = Vector3.new(math.huge, math.huge, math.huge)
                                                velocity.Velocity = direction * math.random(20, 40)
                                                
                                                local pointLight = Instance.new("PointLight", firework)
                                                pointLight.Color = firework.Color
                                                pointLight.Brightness = 2
                                                pointLight.Range = 15
                                                
                                                Debris:AddItem(firework, 5)
                                            end
                                            
                                            local skyExplosion = Instance.new("Sound", Workspace)
                                            skyExplosion.SoundId = "rbxassetid://10066947742"
                                            skyExplosion.Volume = 0.8
                                            skyExplosion.EmitterSize = 75
                                            local explosionSuccess = pcall(function() 
                                                skyExplosion:Play()
                                                if not skyExplosion.IsLoaded then
                                                    skyExplosion.Loaded:Wait()
                                                end
                                            end)
                                            if not explosionSuccess then
                                                -- Usar sonido alternativo
                                                skyExplosion.SoundId = "rbxassetid://1289184659"
                                                pcall(function() skyExplosion:Play() end)
                                                end
                                                    Debris:AddItem(skyExplosion, 3)
                                                end
                                            end)
                                            task.wait(0.25)
                                        end
                                        
                                        task.delay(5, function()
                                            if music then music:Destroy() end
                                            print("🎆 Fuegos artificiales terminados.")
                                        end)
                                    end)
                                end
                                
                                ADMIN_COMMANDS["/muerte"] = function(adminPlayer)
                                    print("💀 EVENTO DE LA MUERTE ACTIVADO POR ADMIN " .. adminPlayer.Name)
                                    
                                    if deathEventActive then
                                        print("❌ El Evento de la Muerte ya está activo.")
                                        return
                                    end
                                    
                                    deathEventActive = true
                                    
                                    local backgroundMusic = Workspace:FindFirstChild("BackgroundMusic")
                                    if backgroundMusic then backgroundMusic:Stop() end
                                    
                                    local eventMusic = Instance.new("Sound", Workspace)
                                    eventMusic.Name = "DeathEventMusic"
                                    eventMusic.SoundId = SOUND_IDS.DeathEventMusic
                                    eventMusic.Looped = true
                                    eventMusic.Volume = 0.8
                                    pcall(function() eventMusic:Play() end)
                                        
                                        local colorCorrection = Instance.new("ColorCorrectionEffect", Lighting)
                                        colorCorrection.Name = "DeathEventEffect"
                                        colorCorrection.Saturation = -1
                                        colorCorrection.Contrast = 0.15
                                        
                                        local hiddenBases = {}
                                        for _, baseModel in ipairs(basesFolder:GetChildren()) do
                                            if baseModel:IsA("Model") then
                                                table.insert(hiddenBases, baseModel)
                                                baseModel.Parent = nil
                                            end
                                        end
                                        
                                        local ancientForest = Instance.new("Folder", Workspace)
                                        ancientForest.Name = "AncientForest"
                                        
                                        local mapFloor = mapFolder:FindFirstChild("Floor")
                                        if mapFloor then
                                            for i = 1, 150 do
                                                local tree = Instance.new("Model", ancientForest)
                                                tree.Name = "AncientTree"
                                                
                                                local trunk = Instance.new("Part", tree)
                                                trunk.Size = Vector3.new(4, math.random(15, 30), 4)
                                                trunk.Color = Color3.fromRGB(87, 59, 15)
                                                trunk.Material = Enum.Material.Wood
                                                trunk.Anchored = true
                                                
                                                local leaves = Instance.new("Part", tree)
                                                leaves.Size = Vector3.new(12, 12, 12)
                                                leaves.Color = Color3.fromRGB(25, 60, 20)
                                                leaves.Material = Enum.Material.Grass
                                                leaves.Shape = Enum.PartType.Ball
                                                leaves.Anchored = true
                                                
                                                local randomX = math.random(-120, 120)
                                                local randomZ = math.random(-120, 120)
                                                local trunkPos = Vector3.new(randomX, trunk.Size.Y / 2, randomZ)
                                                
                                                tree:SetPrimaryPartCFrame(CFrame.new(trunkPos))
                                                trunk.Position = trunkPos
                                                leaves.Position = trunkPos + Vector3.new(0, trunk.Size.Y / 2, 0)
                                            end
                                        end
                                        
                                        task.delay(25, function()
                                            print("💀 El Evento de la Muerte ha terminado. Restaurando el mundo...")
                                            
                                            if eventMusic then eventMusic:Destroy() end
                                            if backgroundMusic then backgroundMusic:Play() end
                                            if colorCorrection then colorCorrection:Destroy() end
                                            
                                            for _, baseModel in ipairs(hiddenBases) do
                                                baseModel.Parent = basesFolder
                                            end
                                            if ancientForest then ancientForest:Destroy() end
                                            
                                            deathEventActive = false
                                        end)
                                    end
                                    
                                    -- Función para detener el spawn de frutas
                                    local function stopFruitSpawn()
                                        isSpawning = false
                                        print("🛑 Spawn de frutas detenido")
                                    end
                                    
                                    ADMIN_COMMANDS["/stopevent"] = function(adminPlayer)
                                        print("🛑 DETENIENDO TODOS LOS EVENTOS POR ADMIN " .. adminPlayer.Name)
                                        
                                        -- Detener spawn de frutas
                                        stopFruitSpawn()
                                        
                                        -- Detener evento brasileño
                                        if brazilianDiscoActive then
                                            brazilianDiscoActive = false
                                            crabSpawnLoopActive = false
                                            print("🇧🇷 Evento brasileño detenido")
                                            
                                            local brazilMusic = Workspace:FindFirstChild("BrazilianDiscoMusic")
                                            if brazilMusic then brazilMusic:Destroy() end
                                            
                                            local backgroundMusic = Workspace:FindFirstChild("BackgroundMusic")
                                            if backgroundMusic then backgroundMusic:Play() end
                                            
                                            local lighting = game:GetService("Lighting")
                                            lighting.Ambient = Color3.fromRGB(138, 138, 138)
                                            lighting.Brightness = 1
                                            lighting.ColorShift_Top = Color3.fromRGB(0, 0, 0)
                                            for _, sky in pairs(lighting:GetChildren()) do
                                                if sky:IsA("Sky") then sky:Destroy() end
                                            end
                                            
                                            local floor = mapFolder:FindFirstChild("Floor")
                                            if floor and originalColors["Floor"] then
                                                floor.Color = originalColors["Floor"]
                                            end
                                            
                                            for _, targetPlayer in pairs(Players:GetPlayers()) do
                                                if playerData[targetPlayer] and playerData[targetPlayer].Base then
                                                    local basePlatform = playerData[targetPlayer].Base:FindFirstChild("BasePlatform")
                                                    if basePlatform and originalColors[targetPlayer.Name .. "_Base"] then
                                                        basePlatform.Color = originalColors[targetPlayer.Name .. "_Base"]
                                                        basePlatform.Material = Enum.Material.Plastic
                                                    end
                                                end
                                                
                                                if targetPlayer.Character and targetPlayer.Character:FindFirstChild("Humanoid") then
                                                    local humanoid = targetPlayer.Character:FindFirstChild("Humanoid")
                                                    humanoid.WalkSpeed = 16
                                                    humanoid.JumpPower = 50
                                                    
                                                    if sambaAnim then sambaAnim:Stop() end
                                                end
                                                
                                                local gui = targetPlayer.PlayerGui:FindFirstChild("BrazilianDiscoGUI")
                                                if gui then gui:Destroy() end
                                            end
                                            
                                            for _, light in pairs(discoLights) do
                                                if light then light:Destroy() end
                                            end
                                            discoLights = {}
                                            
                                            for _, crab in pairs(Workspace:GetChildren()) do
                                                if crab.Name:find("Crab") then
                                                    crab:Destroy()
                                                end
                                            end
                                        end
                                        
                                        -- Detener evento de la muerte
                                        if deathEventActive then
                                            deathEventActive = false
                                            print("💀 Evento de la muerte detenido")
                                            
                                            local eventMusic = Workspace:FindFirstChild("DeathEventMusic")
                                            if eventMusic then eventMusic:Destroy() end
                                            
                                            local backgroundMusic = Workspace:FindFirstChild("BackgroundMusic")
                                            if backgroundMusic then backgroundMusic:Play() end
                                            
                                            local colorCorrection = game:GetService("Lighting"):FindFirstChild("DeathEventEffect")
                                            if colorCorrection then colorCorrection:Destroy() end
                                            
                                            local ancientForest = Workspace:FindFirstChild("AncientForest")
                                            if ancientForest then ancientForest:Destroy() end
                                            
                                            -- Restaurar bases ocultas
                                            for _, player in pairs(Players:GetPlayers()) do
                                                if playerData[player] and playerData[player].Base and not playerData[player].Base.Parent then
                                                    playerData[player].Base.Parent = basesFolder
                                                end
                                            end
                                        end
                                        
                                        -- Detener lluvia de tacos
                                        local rainTacosMusic = Workspace:FindFirstChild("RainTacosMusic")
                                        if rainTacosMusic then
                                            rainTacosMusic:Destroy()
                                            print("🌮 Lluvia de tacos detenida")
                                        end
                                        
                                        -- Detener fuegos artificiales
                                        local fireworkMusic = Workspace:FindFirstChild("FireworkMusic")
                                        if fireworkMusic then
                                            fireworkMusic:Destroy()
                                            print("🎆 Fuegos artificiales detenidos")
                                        end
                                        
                                        -- Limpiar objetos de eventos
                                        for _, obj in pairs(Workspace:GetChildren()) do
                                            if obj.Name == "RainTaco" or obj.Name == "AdminEnemy" then
                                                obj:Destroy()
                                            end
                                        end
                                        
                                        print("✅ Todos los eventos han sido detenidos")
                                    end
                                    
                                    ADMIN_COMMANDS["/startfruits"] = function(adminPlayer)
                                        print("🍎 REINICIANDO SPAWN DE FRUTAS POR ADMIN " .. adminPlayer.Name)
                                        isSpawning = false
                                        task.wait(1)
                                        startFruitSpawn()
                                    end
                                    
                                    -- ######################################################################
                                    -- #############      FIN DEL NUEVO SISTEMA DE COMANDOS      ############
                                    -- ######################################################################
                                    
                                    local function setupPlayer(player)
                                        baseCount = baseCount + 1
                                        if baseCount <= #BASE_POSITIONS then
                                            local posData = BASE_POSITIONS[baseCount]
                                            createBase(player, posData.Position, posData.Orientation)
                                        end
                                        
                                        player.CharacterAdded:Connect(function(char)
                                            -- Crear GUI de dinero si no existe
                                            local moneyGui = player.PlayerGui:FindFirstChild("MoneyGui")
                                            if not moneyGui then
                                                moneyGui = Instance.new("ScreenGui")
                                                moneyGui.Name = "MoneyGui"
                                                moneyGui.ResetOnSpawn = false -- Para que no se reinicie al morir
                                                moneyGui.Parent = player.PlayerGui
                                                
                                                local moneyLabel = Instance.new("TextLabel")
                                                moneyLabel.Size = UDim2.new(0.2, 0, 0.1, 0)
                                                moneyLabel.Position = UDim2.new(0.01, 0, 0.85, 0) -- Posición ajustada
                                                moneyLabel.Text = "Dinero: $0"
                                                moneyLabel.TextScaled = true
                                                moneyLabel.BackgroundTransparency = 1
                                                moneyLabel.Font = Enum.Font.SourceSansBold
                                                moneyLabel.TextColor3 = Color3.fromRGB(0, 255, 0)
                                                moneyLabel.Name = "moneyLabel"
                                                moneyLabel.Parent = moneyGui
                                            end
                                            
                                            -- Crear GUI de nombre si no existe
                                            local head = char:WaitForChild("Head")
                                            local nameGui = head:FindFirstChild("NameGui")
                                            if not nameGui then
                                                nameGui = Instance.new("BillboardGui")
                                                nameGui.Name = "NameGui"
                                                nameGui.Size = UDim2.new(0, 100, 0, 50)
                                                nameGui.StudsOffset = Vector3.new(0, 3, 0) -- Ajustar posición para que esté sobre la cabeza
                                                nameGui.Adornee = head
                                                nameGui.Parent = head
                                                
                                                local nameLabel = Instance.new("TextLabel")
                                                nameLabel.Size = UDim2.new(1, 0, 1, 0)
                                                nameLabel.Text = player.Name
                                                nameLabel.TextScaled = true
                                                nameLabel.BackgroundTransparency = 1
                                                nameLabel.Font = Enum.Font.SourceSansBold
                                                nameLabel.TextColor3 = Color3.new(1, 1, 1)
                                                nameLabel.Parent = nameGui
                                            end
                                            
                                            -- Lógica de la flecha guía para nuevos jugadores
                                            local isFirstJoin = not player:GetAttribute("HasJoinedBefore")
                                            if isFirstJoin and playerData[player] then
                                                player:SetAttribute("HasJoinedBefore", true)
                                                local basePlatform = playerData[player].Base and playerData[player].Base:FindFirstChild("BasePlatform")
                                                if basePlatform then
                                                    local basePosition = basePlatform.Position
                                                    local hrp = char:WaitForChild("HumanoidRootPart", 5)
                                                    if hrp then
                                                        local guideArrow = Instance.new("Part")
                                                        guideArrow.Size = Vector3.new(0.5, 0.5, 0.5)
                                                        guideArrow.Shape = Enum.PartType.Ball
                                                        guideArrow.Color = Color3.fromRGB(255, 255, 0)
                                                        guideArrow.Anchored = true
                                                        guideArrow.CanCollide = false
                                                        guideArrow.Parent = char
                                                        guideArrow.Name = "GuidingArrow"
                                                        
                                                        local arrowGui = Instance.new("BillboardGui")
                                                        arrowGui.Size = UDim2.new(0, 100, 0, 100)
                                                        arrowGui.StudsOffset = Vector3.new(0, 5, 0)
                                                        arrowGui.Adornee = guideArrow
                                                        arrowGui.Parent = guideArrow
                                                        
                                                        local arrowImage = Instance.new("ImageLabel")
                                                        arrowImage.Size = UDim2.new(1, 0, 1, 0)
                                                        arrowImage.BackgroundTransparency = 1
                                                        arrowImage.Image = "rbxassetid://10619717173"
                                                        arrowImage.Parent = arrowGui
                                                        
                                                        local arrowConnection
                                                        arrowConnection = RunService.Heartbeat:Connect(function()
                                                            if not guideArrow.Parent or not hrp.Parent then
                                                                if arrowConnection then arrowConnection:Disconnect() end
                                                                if guideArrow and guideArrow.Parent then guideArrow:Destroy() end
                                                                return
                                                            end
                                                            local playerPos = hrp.Position
                                                            local lookAt = basePosition
                                                            local direction = (lookAt - playerPos).Unit
                                                            local arrowPos = playerPos + direction * 10 + Vector3.new(0, 10, 0)
                                                            guideArrow.CFrame = CFrame.new(arrowPos, lookAt)
                                                        end)
                                                        
                                                        Debris:AddItem(guideArrow, GUIDE_ARROW_DURATION)
                                                        task.delay(GUIDE_ARROW_DURATION, function()
                                                            if arrowConnection then arrowConnection:Disconnect() end
                                                        end)
                                                    end
                                                end
                                            end
                                        end)
                                        
                                        player.Chatted:Connect(function(message)
                                            local messageParts = string.split(message, " ")
                                            local command = (messageParts[1] or ""):lower()
                                            
                                            if IsAdmin(player) then
                                                if ADMIN_COMMANDS[command] then
                                                    local args = {}
                                                    for i = 2, #messageParts do
                                                        table.insert(args, messageParts[i])
                                                    end
                                                    -- Llama a la función del comando con los argumentos desempaquetados
                                                    ADMIN_COMMANDS[command](player, unpack(args))
                                                end
                                            end
                                        end)
                                        
                                        -- ############# NUEVO: Creador del Menú de Admin #############
                                        if IsAdmin(player) then
                                            -- Crear el GUI principal
                                            local adminGui = Instance.new("ScreenGui")
                                            adminGui.Name = "AdminMenuGui"
                                            adminGui.ResetOnSpawn = false
                                            
                                            -- Botón para abrir/cerrar el menú
                                            local menuToggle = Instance.new("TextButton")
                                            menuToggle.Name = "MenuToggle"
                                            menuToggle.Size = UDim2.new(0, 150, 0, 40)
                                            menuToggle.Position = UDim2.new(0.5, -75, 0, 10)
                                            menuToggle.Text = "Menú Admin"
                                            menuToggle.Font = Enum.Font.SourceSansBold
                                            menuToggle.TextScaled = true
                                            menuToggle.BackgroundColor3 = Color3.fromRGB(255, 120, 0)
                                            menuToggle.BorderColor3 = Color3.fromRGB(255, 255, 255)
                                            menuToggle.BorderSizePixel = 2
                                            menuToggle.Parent = adminGui
                                            
                                            -- Panel principal del menú (scrollable)
                                            local commandsFrame = Instance.new("ScrollingFrame")
                                            commandsFrame.Name = "CommandsFrame"
                                            commandsFrame.Size = UDim2.new(0, 450, 0, 300)
                                            commandsFrame.Position = UDim2.new(0.5, -225, 0, 60)
                                            commandsFrame.BackgroundColor3 = Color3.fromRGB(40, 40, 40)
                                            commandsFrame.BackgroundTransparency = 0.2
                                            commandsFrame.BorderSizePixel = 2
                                            commandsFrame.BorderColor3 = Color3.fromRGB(255, 120, 0)
                                            commandsFrame.Visible = false
                                            commandsFrame.CanvasSize = UDim2.new(0, 0, 0, 0) -- Se ajustará automáticamente
                                            commandsFrame.Parent = adminGui
                                            
                                            local uiList = Instance.new("UIListLayout", commandsFrame)
                                            uiList.Padding = UDim.new(0, 5)
                                            uiList.SortOrder = Enum.SortOrder.LayoutOrder
                                            
                                            local uiPadding = Instance.new("UIPadding", commandsFrame)
                                            uiPadding.PaddingTop = UDim.new(0, 5)
                                            uiPadding.PaddingLeft = UDim.new(0, 5)
                                            
                                            -- Función para crear una entrada de comando en el menú
                                            local function createCommandEntry(commandName, argsPlaceholders, layoutOrder)
                                                local entryFrame = Instance.new("Frame")
                                                entryFrame.Name = commandName
                                                entryFrame.Size = UDim2.new(1, -10, 0, 40)
                                                entryFrame.BackgroundColor3 = Color3.fromRGB(60, 60, 60)
                                                entryFrame.LayoutOrder = layoutOrder
                                                entryFrame.Parent = commandsFrame
                                                
                                                local commandLabel = Instance.new("TextLabel", entryFrame)
                                                commandLabel.Size = UDim2.new(0.3, 0, 1, 0)
                                                commandLabel.Text = commandName
                                                commandLabel.Font = Enum.Font.SourceSans
                                                commandLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
                                                commandLabel.BackgroundTransparency = 1
                                                commandLabel.TextXAlignment = Enum.TextXAlignment.Left
                                                
                                                local argLayout = Instance.new("UIListLayout", entryFrame)
                                                argLayout.FillDirection = Enum.FillDirection.Horizontal
                                                argLayout.Padding = UDim.new(0, 5)
                                                
                                                local argWidth = (0.7 - 0.2) / math.max(1, #argsPlaceholders)
                                                
                                                for i, placeholder in ipairs(argsPlaceholders) do
                                                    local argBox = Instance.new("TextBox")
                                                    argBox.Name = "Arg" .. i
                                                    argBox.Size = UDim2.new(argWidth, -5, 1, -10)
                                                    argBox.PlaceholderText = placeholder
                                                    argBox.Font = Enum.Font.SourceSans
                                                    argBox.BackgroundColor3 = Color3.fromRGB(20, 20, 20)
                                                    argBox.TextColor3 = Color3.fromRGB(255, 255, 255)
                                                    argBox.ClearTextOnFocus = false
                                                    argBox.Parent = entryFrame
                                                end
                                                
                                                local executeBtn = Instance.new("TextButton")
                                                executeBtn.Name = "ExecuteButton"
                                                executeBtn.Size = UDim2.new(0.2, 0, 1, -10)
                                                executeBtn.Text = "Ejecutar"
                                                executeBtn.Font = Enum.Font.SourceSansBold
                                                executeBtn.BackgroundColor3 = Color3.fromRGB(0, 180, 0)
                                                executeBtn.TextColor3 = Color3.fromRGB(255, 255, 255)
                                                executeBtn.Parent = entryFrame
                                            end
                                            
                                            -- Crear entradas para cada comando
                                            createCommandEntry("/givemoney", {"Jugador", "Cantidad"}, 1)
                                            createCommandEntry("/teleport", {"Jugador"}, 2)
                                            createCommandEntry("/spawnenemy", {"Cantidad"}, 3)
                                            createCommandEntry("/adminabuse", {}, 4)
                                            createCommandEntry("/cleanup", {}, 5)
                                            createCommandEntry("/raintacos", {}, 6)
                                            createCommandEntry("/brasil", {}, 7)
                                            createCommandEntry("/fuegos", {}, 8)
                                            createCommandEntry("/muerte", {}, 9)
                                            createCommandEntry("/stopevent", {}, 10)
                                            
                                            -- Configuración del GUI usando RemoteEvents para la funcionalidad
                                            local function setupGuiEvents()
                                                local toggleEvent = Instance.new("RemoteEvent")
                                                toggleEvent.Name = "ToggleAdminMenu"
                                                toggleEvent.Parent = ReplicatedStorage
                                                
                                                toggleEvent.OnServerEvent:Connect(function(player)
                                                    if not IsAdmin(player) then return end
                                                    -- El toggle se maneja en el cliente
                                                end)
                                            end
                                            setupGuiEvents()
                                            
                                            -- Añadir el GUI al jugador
                                            adminGui.Parent = player.PlayerGui
                                        end
                                    end
                                    
                                    -- Listener en el servidor para el evento de ejecución de comandos
                                    ExecuteAdminCommandEvent.OnServerEvent:Connect(function(player, command, args)
                                        if not IsAdmin(player) then return end -- Doble chequeo de seguridad
                                            
                                            local commandFunc = ADMIN_COMMANDS[command]
                                            if commandFunc then
                                                -- Ejecuta el comando con los argumentos recibidos
                                                commandFunc(player, unpack(args))
                                            else
                                                warn("El jugador " .. player.Name .. " intentó ejecutar un comando desconocido: " .. command)
                                            end
                                        end)
                                        
                                        -- SISTEMA DE INGRESOS PASIVOS DE FRUTAS
                                        task.spawn(function()
                                            while true do
                                                task.wait(1)
                                                
                                                for _, player in pairs(Players:GetPlayers()) do
                                                    if playerData[player] and playerData[player].Base then
                                                        local totalIncome = 0
                                                        
                                                        for i = 1, 6 do
                                                            local quadName = "FruitQuad" .. i
                                                            local quad = playerData[player].Base:FindFirstChild(quadName)
                                                            if quad then
                                                                for _, child in pairs(quad:GetChildren()) do
                                                                    if child:IsA("Model") and child:GetAttribute("IncomeRate") then
                                                                        local income = child:GetAttribute("IncomeRate")
                                                                        totalIncome = totalIncome + income
                                                                    end
                                                                end
                                                            end
                                                        end
                                                        
                                                        if totalIncome > 0 then
                                                            playerData[player].Money = playerData[player].Money + totalIncome
                                                            updateMoneyLabel(player)
                                                            
                                                            local gui = player.PlayerGui:FindFirstChild("IncomeNotification")
                                                            if gui then gui:Destroy() end
                                                            
                                                            gui = Instance.new("ScreenGui", player.PlayerGui)
                                                            gui.Name = "IncomeNotification"
                                                            
                                                            local notification = Instance.new("TextLabel", gui)
                                                            notification.Size = UDim2.new(0.2, 0, 0.05, 0)
                                                            notification.Position = UDim2.new(0.4, 0, 0.3, 0)
                                                            notification.Text = "+$" .. totalIncome
                                                            notification.TextScaled = true
                                                            notification.BackgroundColor3 = Color3.fromRGB(0, 255, 0)
                                                            notification.TextColor3 = Color3.fromRGB(255, 255, 255)
                                                            
                                                            local tweenInfo = TweenInfo.new(2, Enum.EasingStyle.Quart, Enum.EasingDirection.Out)
                                                            local tween = TweenService:Create(notification, tweenInfo, {
                                                            Position = UDim2.new(0.4, 0, 0.2, 0),
                                                            TextTransparency = 1
                                                            })
                                                            tween:Play()
                                                            
                                                            Debris:AddItem(gui, 2)
                                                        end
                                                    end
                                                end
                                            end
                                        end)
                                        
                                        -- INICIALIZAR SISTEMAS
                                        createMap()
                                        
                                        for _, player in ipairs(Players:GetPlayers()) do
                                            setupPlayer(player)
                                        end
                                        
                                        Players.PlayerAdded:Connect(setupPlayer)
                                        
                                        Players.PlayerRemoving:Connect(function(player)
                                            if playerData[player] then
                                                if playerData[player].Base and playerData[player].Base.Parent then
                                                    playerData[player].Base:Destroy()
                                                end
                                                playerData[player] = nil
                                            end
                                        end)
                                        
                                        startFruitSpawn()
